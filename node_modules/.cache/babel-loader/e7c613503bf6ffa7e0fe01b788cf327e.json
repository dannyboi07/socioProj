{"ast":null,"code":"import _asyncToGenerator from\"/home/runner/work/socioProj/socioProj/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/home/runner/work/socioProj/socioProj/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/home/runner/work/socioProj/socioProj/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/home/runner/work/socioProj/socioProj/node_modules/@babel/runtime/regenerator/index.js\";import{createPost,getAllService,likePost,unlikePost}from\"../services/contentService\";import{setFailure}from\"./failureReducer\";import{setStatusNotif}from\"./statusNotifReducer\";import{dispatchLogOut}from\"./userReducer\";import changeroute from\"../utils/customEvents\";export default function postblogReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case\"GET_ALL\":return state=_objectSpread({},action.data);case\"GET_BLOGS\":return state=_objectSpread({},action.data);case\"GET_POSTS\":return state=_objectSpread({},action.data);case\"CREATE_POST\":return{posts:[].concat(_toConsumableArray(action.data),_toConsumableArray(state.posts)),blogs:_toConsumableArray(state.blogs)};case\"LIKE_POST\":return state=_objectSpread(_objectSpread({},state),{},{posts:state.posts.map(function(post){return post.p_id===action.data?_objectSpread({likes:post.likes+=1},post):post;})});case\"UNLIKE_POST\":return state=_objectSpread(_objectSpread({},state),{},{posts:state.posts.map(function(post){return post.p_id===action.data?_objectSpread({likes:post.likes-=1},post):post;})});case\"CLR_POSTS\":return null;default:return state;}}function getAll(token){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var all;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getAllService(token);case 3:all=_context.sent;_context.next=16;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);console.error(_context.t0);if(!(_context.t0.response&&_context.t0.response.status===401)){_context.next=14;break;}dispatch(dispatchLogOut());dispatch(setStatusNotif(\"SET_ERR_NOTIF\",_context.t0.response.data.error,3));window.dispatchEvent(changeroute);return _context.abrupt(\"return\");case 14:dispatch(setFailure(\"CONTENT\",{func:getAll,param:token}));return _context.abrupt(\"return\");case 16:// Finally, if all good\ndispatch({type:\"GET_ALL\",data:all});case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return function(_x){return _ref.apply(this,arguments);};}();}function sendPost(postContent,token){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return createPost(postContent,token);case 3:response=_context2.sent;_context2.next=16;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);if(!(_context2.t0.response&&_context2.t0.response.status===401)){_context2.next=14;break;}dispatch(dispatchLogOut());dispatch(setStatusNotif(\"SET_ERR_NOTIF\",_context2.t0.response.data.error,3));window.dispatchEvent(changeroute);return _context2.abrupt(\"return\");case 14:dispatch(setStatusNotif(\"SET_ERR_NOTIF\",_context2.t0.response.data.error,3));return _context2.abrupt(\"return\");case 16:dispatch({type:\"CREATE_POST\",data:response});case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();}function likePostRdx(postId,token){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return likePost(postId,token);case 3:_context3.next=15;break;case 5:_context3.prev=5;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0);if(!(_context3.t0.response&&_context3.t0.response.status===401)){_context3.next=13;break;}dispatch(dispatchLogOut());dispatch(setStatusNotif(\"SET_ERR_NOTIF\",_context3.t0.response.data.error,3));window.dispatchEvent(changeroute);return _context3.abrupt(\"return\");case 13:dispatch(setStatusNotif(\"SET_ERR_NOTIF\",_context3.t0.response.data.error,3));return _context3.abrupt(\"return\");case 15:dispatch({type:\"LIKE_POST\",data:postId});case 16:case\"end\":return _context3.stop();}}},_callee3,null,[[0,5]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();}function unLikePostRdx(postId,token){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return unlikePost(postId,token);case 3:_context4.next=15;break;case 5:_context4.prev=5;_context4.t0=_context4[\"catch\"](0);console.error(_context4.t0);if(!(_context4.t0.response&&_context4.t0.response.status===401)){_context4.next=13;break;}dispatch(dispatchLogOut());dispatch(setStatusNotif(\"SET_ERR_NOTIF\",_context4.t0.response.data.error,3));window.dispatchEvent(changeroute);return _context4.abrupt(\"return\");case 13:dispatch(setStatusNotif(\"SET_ERR_NOTIF\",_context4.t0.response.data.error,3));return _context4.abrupt(\"return\");case 15:dispatch({type:\"UNLIKE_POST\",data:postId});case 16:case\"end\":return _context4.stop();}}},_callee4,null,[[0,5]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();}function clrPosts(){return{type:\"CLR_POSTS\",data:null};}export{getAll,sendPost,likePostRdx,unLikePostRdx,clrPosts};","map":{"version":3,"sources":["/home/runner/work/socioProj/socioProj/src/reducers/postblogReducer.js"],"names":["createPost","getAllService","likePost","unlikePost","setFailure","setStatusNotif","dispatchLogOut","changeroute","postblogReducer","state","action","type","data","posts","blogs","map","post","p_id","likes","getAll","token","dispatch","all","console","error","response","status","window","dispatchEvent","func","param","sendPost","postContent","likePostRdx","postId","unLikePostRdx","clrPosts"],"mappings":"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","sourcesContent":["import {\n\tcreatePost,\n\tgetAllService,\n\tlikePost,\n\tunlikePost,\n} from \"../services/contentService\";\nimport { setFailure } from \"./failureReducer\";\nimport { setStatusNotif } from \"./statusNotifReducer\";\nimport { dispatchLogOut } from \"./userReducer\";\nimport changeroute from \"../utils/customEvents\";\n\nexport default function postblogReducer(state = null, action) {\n\tswitch (action.type) {\n\tcase \"GET_ALL\":\n\t\treturn (state = { ...action.data });\n\tcase \"GET_BLOGS\":\n\t\treturn (state = { ...action.data });\n\tcase \"GET_POSTS\":\n\t\treturn (state = { ...action.data });\n\tcase \"CREATE_POST\":\n\t\treturn {\n\t\t\tposts: [...action.data, ...state.posts],\n\t\t\tblogs: [...state.blogs],\n\t\t};\n\tcase \"LIKE_POST\":\n\t\treturn (state = {\n\t\t\t...state,\n\t\t\tposts: state.posts.map((post) =>\n\t\t\t\tpost.p_id === action.data\n\t\t\t\t\t? { likes: (post.likes += 1), ...post }\n\t\t\t\t\t: post,\n\t\t\t),\n\t\t});\n\tcase \"UNLIKE_POST\":\n\t\treturn (state = {\n\t\t\t...state,\n\t\t\tposts: state.posts.map((post) =>\n\t\t\t\tpost.p_id === action.data\n\t\t\t\t\t? { likes: (post.likes -= 1), ...post }\n\t\t\t\t\t: post,\n\t\t\t),\n\t\t});\n\tcase \"CLR_POSTS\":\n\t\treturn null;\n\tdefault:\n\t\treturn state;\n\t}\n}\n\nfunction getAll(token) {\n\treturn async (dispatch) => {\n\t\tlet all;\n\t\ttry {\n\t\t\tall = await getAllService(token);\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\tif (err.response && err.response.status === 401) {\n\t\t\t\tdispatch(dispatchLogOut());\n\t\t\t\tdispatch(\n\t\t\t\t\tsetStatusNotif(\n\t\t\t\t\t\t\"SET_ERR_NOTIF\",\n\t\t\t\t\t\terr.response.data.error,\n\t\t\t\t\t\t3,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\twindow.dispatchEvent(changeroute);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdispatch(\n\t\t\t\tsetFailure(\"CONTENT\", {\n\t\t\t\t\tfunc: getAll,\n\t\t\t\t\tparam: token,\n\t\t\t\t}),\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\t// Finally, if all good\n\t\tdispatch({\n\t\t\ttype: \"GET_ALL\",\n\t\t\tdata: all,\n\t\t});\n\t};\n}\n\nfunction sendPost(postContent, token) {\n\treturn async (dispatch) => {\n\t\tlet response;\n\t\ttry {\n\t\t\tresponse = await createPost(postContent, token);\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\tif (err.response && err.response.status === 401) {\n\t\t\t\tdispatch(dispatchLogOut());\n\t\t\t\tdispatch(\n\t\t\t\t\tsetStatusNotif(\n\t\t\t\t\t\t\"SET_ERR_NOTIF\",\n\t\t\t\t\t\terr.response.data.error,\n\t\t\t\t\t\t3,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\twindow.dispatchEvent(changeroute);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdispatch(\n\t\t\t\tsetStatusNotif(\"SET_ERR_NOTIF\", err.response.data.error, 3),\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tdispatch({\n\t\t\ttype: \"CREATE_POST\",\n\t\t\tdata: response,\n\t\t});\n\t};\n}\n\nfunction likePostRdx(postId, token) {\n\treturn async (dispatch) => {\n\t\t// let response;\n\t\ttry {\n\t\t\tawait likePost(postId, token);\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\tif (err.response && err.response.status === 401) {\n\t\t\t\tdispatch(dispatchLogOut());\n\t\t\t\tdispatch(\n\t\t\t\t\tsetStatusNotif(\n\t\t\t\t\t\t\"SET_ERR_NOTIF\",\n\t\t\t\t\t\terr.response.data.error,\n\t\t\t\t\t\t3,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\twindow.dispatchEvent(changeroute);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdispatch(\n\t\t\t\tsetStatusNotif(\"SET_ERR_NOTIF\", err.response.data.error, 3),\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tdispatch({\n\t\t\ttype: \"LIKE_POST\",\n\t\t\tdata: postId,\n\t\t});\n\t};\n}\n\nfunction unLikePostRdx(postId, token) {\n\treturn async (dispatch) => {\n\t\t// let response;\n\t\ttry {\n\t\t\tawait unlikePost(postId, token);\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\tif (err.response && err.response.status === 401) {\n\t\t\t\tdispatch(dispatchLogOut());\n\t\t\t\tdispatch(\n\t\t\t\t\tsetStatusNotif(\n\t\t\t\t\t\t\"SET_ERR_NOTIF\",\n\t\t\t\t\t\terr.response.data.error,\n\t\t\t\t\t\t3,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\twindow.dispatchEvent(changeroute);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdispatch(\n\t\t\t\tsetStatusNotif(\"SET_ERR_NOTIF\", err.response.data.error, 3),\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tdispatch({\n\t\t\ttype: \"UNLIKE_POST\",\n\t\t\tdata: postId,\n\t\t});\n\t};\n}\n\nfunction clrPosts() {\n\treturn {\n\t\ttype: \"CLR_POSTS\",\n\t\tdata: null,\n\t};\n}\n\nexport { getAll, sendPost, likePostRdx, unLikePostRdx, clrPosts };\n"]},"metadata":{},"sourceType":"module"}