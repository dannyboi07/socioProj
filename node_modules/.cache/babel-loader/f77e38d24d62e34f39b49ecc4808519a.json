{"ast":null,"code":"import _asyncToGenerator from\"/home/runner/work/socioProj/socioProj/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/home/runner/work/socioProj/socioProj/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/home/runner/work/socioProj/socioProj/node_modules/@babel/runtime/regenerator/index.js\";import{getContacted,getMsgs,postMsg}from\"../services/messageService\";import{setFailure}from\"./failureReducer\";import{setStatusNotif}from\"./statusNotifReducer\";export default function messagingReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case\"GET_CONTACTED\":return{contacted:_toConsumableArray(action.data),messages:[]};case\"GET_MSGS\":return{contacted:_toConsumableArray(state.contacted),messages:_toConsumableArray(action.data)};case\"ADD_MSG\":return{contacted:_toConsumableArray(state.contacted),messages:[].concat(_toConsumableArray(action.data),_toConsumableArray(state.messages))};case\"ADD_NEW_CHAT\":// eslint-disable-next-line no-case-declarations\nvar exists=false;for(var i=0;i<state.contacted.length;i++){if(state.contacted[i].u_id===action.data.u_id){exists=true;}}return{contacted:exists?_toConsumableArray(state.contacted):[action.data].concat(_toConsumableArray(state.contacted)),messages:_toConsumableArray(state.messages)};case\"CLR_MSGING\":return null;default:return state;}}function getContactedRdx(token){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var resContacted;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getContacted(token);case 3:resContacted=_context.sent;_context.next=11;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);console.error(_context.t0);dispatch(setFailure(\"MSGING\",{func:getContactedRdx,param:token}));return _context.abrupt(\"return\");case 11:dispatch({type:\"GET_CONTACTED\",data:resContacted});case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return function(_x){return _ref.apply(this,arguments);};}();}function getMsgsRdx(token,frndUid){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var msgs;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return getMsgs(token,frndUid);case 3:msgs=_context2.sent;_context2.next=10;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);return _context2.abrupt(\"return\");case 10:dispatch({type:\"GET_MSGS\",data:msgs});case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();}function postMsgRdx(token,frndUid,msgText){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var resMsg;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return postMsg(token,frndUid,msgText);case 3:resMsg=_context3.sent;_context3.next=11;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0);dispatch(setStatusNotif(\"SET_ERR_NOTIF\",\"Failed to send message\",3));return _context3.abrupt(\"return\");case 11:dispatch({type:\"ADD_MSG\",data:resMsg});case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();}function addMsg(data){return{type:\"ADD_MSG\",data:data};}function addChat(data){return{type:\"ADD_NEW_CHAT\",data:data};}function clrMsging(){return{type:\"CLR_MSGING\",data:null};}export{getContactedRdx,getMsgsRdx,clrMsging,postMsgRdx,addMsg,addChat};// contacted: state.contacted.map(contact => {\n//     if (contact.u_id === action.data.u_id) {\n//         return contact;\n//     } else if (contact.u_id !== action.data.u_id) {\n//         return action.data;\n//     }\n// }),\n// contacted: state.contacted.map(contact => contact.u_id === action.data.u_id ? contact : action.data),","map":{"version":3,"sources":["/home/runner/work/socioProj/socioProj/src/reducers/messagingReducer.js"],"names":["getContacted","getMsgs","postMsg","setFailure","setStatusNotif","messagingReducer","state","action","type","contacted","data","messages","exists","i","length","u_id","getContactedRdx","token","dispatch","resContacted","console","error","func","param","getMsgsRdx","frndUid","msgs","postMsgRdx","msgText","resMsg","addMsg","addChat","clrMsging"],"mappings":"4XAAA,OAASA,YAAT,CAAuBC,OAAvB,CAAgCC,OAAhC,KAA+C,4BAA/C,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,cAAT,KAA+B,sBAA/B,CAEA,cAAe,SAASC,CAAAA,gBAAT,EAAgD,IAAtBC,CAAAA,KAAsB,2DAAd,IAAc,IAARC,CAAAA,MAAQ,2CAC9D,OAAQA,MAAM,CAACC,IAAf,EACA,IAAK,eAAL,CACC,MAAO,CACNC,SAAS,oBAAMF,MAAM,CAACG,IAAb,CADH,CAENC,QAAQ,CAAE,EAFJ,CAAP,CAID,IAAK,UAAL,CACC,MAAO,CACNF,SAAS,oBAAMH,KAAK,CAACG,SAAZ,CADH,CAENE,QAAQ,oBAAMJ,MAAM,CAACG,IAAb,CAFF,CAAP,CAID,IAAK,SAAL,CACC,MAAO,CACND,SAAS,oBAAMH,KAAK,CAACG,SAAZ,CADH,CAENE,QAAQ,8BAAMJ,MAAM,CAACG,IAAb,qBAAsBJ,KAAK,CAACK,QAA5B,EAFF,CAAP,CAID,IAAK,cAAL,CACC;AACA,GAAIC,CAAAA,MAAM,CAAG,KAAb,CACA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGP,KAAK,CAACG,SAAN,CAAgBK,MAApC,CAA4CD,CAAC,EAA7C,CAAiD,CAChD,GAAIP,KAAK,CAACG,SAAN,CAAgBI,CAAhB,EAAmBE,IAAnB,GAA4BR,MAAM,CAACG,IAAP,CAAYK,IAA5C,CAAkD,CACjDH,MAAM,CAAG,IAAT,CACA,CACD,CACD,MAAO,CACNH,SAAS,CAAEG,MAAM,oBACVN,KAAK,CAACG,SADI,GAEbF,MAAM,CAACG,IAFM,4BAEGJ,KAAK,CAACG,SAFT,EADX,CAINE,QAAQ,oBAAML,KAAK,CAACK,QAAZ,CAJF,CAAP,CAMD,IAAK,YAAL,CACC,MAAO,KAAP,CACD,QACC,MAAOL,CAAAA,KAAP,CAjCD,CAmCA,CAED,QAASU,CAAAA,eAAT,CAAyBC,KAAzB,CAAgC,CAC/B,+FAAO,iBAAOC,QAAP,yKAGgBlB,CAAAA,YAAY,CAACiB,KAAD,CAH5B,QAGLE,YAHK,8FAKLC,OAAO,CAACC,KAAR,cACAH,QAAQ,CACPf,UAAU,CAAC,QAAD,CAAW,CACpBmB,IAAI,CAAEN,eADc,CAEpBO,KAAK,CAAEN,KAFa,CAAX,CADH,CAAR,CANK,yCAeNC,QAAQ,CAAC,CACRV,IAAI,CAAE,eADE,CAERE,IAAI,CAAES,YAFE,CAAD,CAAR,CAfM,oEAAP,+DAoBA,CAED,QAASK,CAAAA,UAAT,CAAoBP,KAApB,CAA2BQ,OAA3B,CAAoC,CACnC,gGAAO,kBAAOP,QAAP,uKAGQjB,CAAAA,OAAO,CAACgB,KAAD,CAAQQ,OAAR,CAHf,QAGLC,IAHK,mGAKLN,OAAO,CAACC,KAAR,eALK,0CAQNH,QAAQ,CAAC,CACRV,IAAI,CAAE,UADE,CAERE,IAAI,CAAEgB,IAFE,CAAD,CAAR,CARM,sEAAP,iEAaA,CAED,QAASC,CAAAA,UAAT,CAAoBV,KAApB,CAA2BQ,OAA3B,CAAoCG,OAApC,CAA6C,CAC5C,gGAAO,kBAAOV,QAAP,yKAGUhB,CAAAA,OAAO,CAACe,KAAD,CAAQQ,OAAR,CAAiBG,OAAjB,CAHjB,QAGLC,MAHK,mGAKLT,OAAO,CAACC,KAAR,eACAH,QAAQ,CACPd,cAAc,CAAC,eAAD,CAAkB,wBAAlB,CAA4C,CAA5C,CADP,CAAR,CANK,0CAWNc,QAAQ,CAAC,CACRV,IAAI,CAAE,SADE,CAERE,IAAI,CAAEmB,MAFE,CAAD,CAAR,CAXM,sEAAP,iEAgBA,CAED,QAASC,CAAAA,MAAT,CAAgBpB,IAAhB,CAAsB,CACrB,MAAO,CACNF,IAAI,CAAE,SADA,CAENE,IAAI,CAAJA,IAFM,CAAP,CAIA,CAED,QAASqB,CAAAA,OAAT,CAAiBrB,IAAjB,CAAuB,CACtB,MAAO,CACNF,IAAI,CAAE,cADA,CAENE,IAAI,CAAJA,IAFM,CAAP,CAIA,CAED,QAASsB,CAAAA,SAAT,EAAqB,CACpB,MAAO,CACNxB,IAAI,CAAE,YADA,CAENE,IAAI,CAAE,IAFA,CAAP,CAIA,CAED,OAASM,eAAT,CAA0BQ,UAA1B,CAAsCQ,SAAtC,CAAiDL,UAAjD,CAA6DG,MAA7D,CAAqEC,OAArE,EAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import { getContacted, getMsgs, postMsg } from \"../services/messageService\";\nimport { setFailure } from \"./failureReducer\";\nimport { setStatusNotif } from \"./statusNotifReducer\";\n\nexport default function messagingReducer(state = null, action) {\n\tswitch (action.type) {\n\tcase \"GET_CONTACTED\":\n\t\treturn {\n\t\t\tcontacted: [...action.data],\n\t\t\tmessages: [],\n\t\t};\n\tcase \"GET_MSGS\":\n\t\treturn {\n\t\t\tcontacted: [...state.contacted],\n\t\t\tmessages: [...action.data],\n\t\t};\n\tcase \"ADD_MSG\":\n\t\treturn {\n\t\t\tcontacted: [...state.contacted],\n\t\t\tmessages: [...action.data, ...state.messages],\n\t\t};\n\tcase \"ADD_NEW_CHAT\":\n\t\t// eslint-disable-next-line no-case-declarations\n\t\tlet exists = false;\n\t\tfor (let i = 0; i < state.contacted.length; i++) {\n\t\t\tif (state.contacted[i].u_id === action.data.u_id) {\n\t\t\t\texists = true;\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tcontacted: exists\n\t\t\t\t? [...state.contacted]\n\t\t\t\t: [action.data, ...state.contacted],\n\t\t\tmessages: [...state.messages],\n\t\t};\n\tcase \"CLR_MSGING\":\n\t\treturn null;\n\tdefault:\n\t\treturn state;\n\t}\n}\n\nfunction getContactedRdx(token) {\n\treturn async (dispatch) => {\n\t\tlet resContacted;\n\t\ttry {\n\t\t\tresContacted = await getContacted(token);\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\tdispatch(\n\t\t\t\tsetFailure(\"MSGING\", {\n\t\t\t\t\tfunc: getContactedRdx,\n\t\t\t\t\tparam: token,\n\t\t\t\t}),\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tdispatch({\n\t\t\ttype: \"GET_CONTACTED\",\n\t\t\tdata: resContacted,\n\t\t});\n\t};\n}\n\nfunction getMsgsRdx(token, frndUid) {\n\treturn async (dispatch) => {\n\t\tlet msgs;\n\t\ttry {\n\t\t\tmsgs = await getMsgs(token, frndUid);\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\treturn;\n\t\t}\n\t\tdispatch({\n\t\t\ttype: \"GET_MSGS\",\n\t\t\tdata: msgs,\n\t\t});\n\t};\n}\n\nfunction postMsgRdx(token, frndUid, msgText) {\n\treturn async (dispatch) => {\n\t\tlet resMsg;\n\t\ttry {\n\t\t\tresMsg = await postMsg(token, frndUid, msgText);\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\tdispatch(\n\t\t\t\tsetStatusNotif(\"SET_ERR_NOTIF\", \"Failed to send message\", 3),\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tdispatch({\n\t\t\ttype: \"ADD_MSG\",\n\t\t\tdata: resMsg,\n\t\t});\n\t};\n}\n\nfunction addMsg(data) {\n\treturn {\n\t\ttype: \"ADD_MSG\",\n\t\tdata,\n\t};\n}\n\nfunction addChat(data) {\n\treturn {\n\t\ttype: \"ADD_NEW_CHAT\",\n\t\tdata,\n\t};\n}\n\nfunction clrMsging() {\n\treturn {\n\t\ttype: \"CLR_MSGING\",\n\t\tdata: null,\n\t};\n}\n\nexport { getContactedRdx, getMsgsRdx, clrMsging, postMsgRdx, addMsg, addChat };\n\n// contacted: state.contacted.map(contact => {\n//     if (contact.u_id === action.data.u_id) {\n//         return contact;\n//     } else if (contact.u_id !== action.data.u_id) {\n//         return action.data;\n//     }\n// }),\n// contacted: state.contacted.map(contact => contact.u_id === action.data.u_id ? contact : action.data),\n"]},"metadata":{},"sourceType":"module"}